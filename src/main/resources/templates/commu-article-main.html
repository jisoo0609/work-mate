<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:if="${selectedBoard == null}">게시판: 전체 게시판</title>
  <title th:unless="${selectedBoard == null}">게시판: [[${selectedBoard.board}]]</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

  <style>
      .table th:nth-child(1), .table td:nth-child(1) { width: 5%; } /* # */
      .table th:nth-child(2), .table td:nth-child(2) { width: 50%; } /* 제목 */
      .table th:nth-child(3), .table td:nth-child(3) { width: 20%; } /* 작성자 */
      .table th:nth-child(4), .table td:nth-child(4) { width: 25%; } /* 작성 시간 */
  </style>
</head>

<body class="p-3">
<!-- 게시판 목록 -->
<div class="d-flex justify-content-center mt-3 fs-6">
  <a th:href="@{'/' + ${shopId} + '/community'}" class="btn btn-primary me-3">전체 게시판</a>
  <div th:each="boardItem : ${boards}">
    <a th:href="@{'/' + ${shopId} + '/community/' + ${boardItem.name()}}" th:text="${boardItem.board}"
       class=" btn btn-info me-3"></a>
  </div>
</div>
<hr>

<div class="container mt-3 mb-5">
  <!-- 선택한 게시판 이름 -->
  <div class="d-flex align-items-center">
    <h1 class="me-3" th:if="${selectedBoard == null}">전체 게시판</h1>
    <h1 class="me-3" th:unless="${selectedBoard == null}" th:text="${selectedBoard.board}">게시판 이름</h1>
  </div>
  <hr>
  <div class="container mb-5">
    <!-- 공지사항 게시글 리스트 -->
    <div th:if="${noticeArticles != null and !noticeArticles.empty}" class="table-responsive">
      <table class="table">
        <thead>
        <tr>
          <th>#</th>
          <th>제목</th>
          <th>작성자</th>
          <th>작성 시간</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="notice : ${noticeArticles}">
          <td>공지</td>
          <td>
            <a th:href="@{'/' + ${shopId} + '/community/NOTICE/' + ${notice.shopArticleId}}" th:text="${notice.title}"></a>
          </td>
          <td th:text="${notice.accountName}"></td>
          <td th:text="${#temporals.format(notice.articleWriteTime, 'yyyy-MM-dd HH:mm')}"></td>
        </tr>
        </tbody>
      </table>
    </div>
    <!-- 일반 게시글 리스트 -->
    <div th:if="${articles != null and !articles.empty}" class="table-responsive">
      <table class="table">
        <tbody>
        <tr th:each="article : ${articles}">
          <td th:text="${article.shopArticleId}"></td>
          <td>
            <a th:href="@{'/' + ${shopId} + '/community/' + ${article.board} + '/' + ${article.shopArticleId}}" th:text="${article.title}"></a>
          </td>
          <td th:text="${article.accountName}"></td>
          <td th:text="${#temporals.format(article.articleWriteTime, 'yyyy-MM-dd HH:mm')}"></td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <!-- 글쓰기 버튼 -->
  <div class="d-flex justify-content-end mb-3">
    <a class="btn btn-secondary" th:href="@{'/' + ${shopId} + '/community/article/new'}">게시글 작성</a>
  </div>

  <!-- 검색 -->
  <div th:with="baseURL='/' + ${shopId} + '/community',
              boardURL=(${selectedBoard} != null) ? ('/' + ${selectedBoard.name()}) : '',
              actionURL=${baseURL + boardURL}"
       class="container" style="max-width: 600px;">
    <form th:action="${actionURL}" method="GET">
      <div class="row justify-content-center">
        <div class="col-auto">
          <select class="form-select" name="type">
            <option value="title">제목</option>
            <option value="content">내용</option>
          </select>
        </div>
        <div class="col">
          <input type="text" class="form-control" placeholder="검색어 입력" name="keyword">
        </div>
        <div class="col-auto">
          <button type="submit" class="btn btn-primary">검색</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- 페이지 -->
<div class="d-flex justify-content-center mt-3">
  <ul class="pagination">
    <!-- 처음 페이지 링크 -->
    <li class="page-item" th:classappend="${articles.first} ? 'disabled' : ''">
      <a class="page-link"
         th:href="@{'/' + ${shopId} + '/community' + (${selectedBoard} != null ? '/' + ${selectedBoard.name} : '') + '?page=0'}">처음</a>
    </li>
    <!-- 이전 페이지 링크 -->
    <li class="page-item" th:classappend="${articles.hasPrevious} ? '' : 'disabled'">
      <a class="page-link"
         th:href="@{'/' + ${shopId} + '/community' + (${selectedBoard} != null ? '/' + ${selectedBoard.name} : '') + '?page=' + (${articles.number} - 1)}">이전</a>
    </li>
    <!-- 페이지 번호 링크 -->
    <li class="page-item" th:each="pageNum : ${#numbers.sequence(0, articles.totalPages - 1)}"
        th:classappend="${pageNum == articles.number} ? 'active' : ''">
      <a class="page-link"
         th:href="@{'/' + ${shopId} + '/community' + (${selectedBoard} != null ? '/' + ${selectedBoard.name} : '') + '?page=' + ${pageNum}}"
         th:text="${pageNum + 1}"></a>
    </li>
    <!-- 다음 페이지 링크 -->
    <li class="page-item" th:classappend="${articles.hasNext} ? '' : 'disabled'">
      <a class="page-link"
         th:href="@{'/' + ${shopId} + '/community' + (${selectedBoard} != null ? '/' + ${selectedBoard.name} : '') + '?page=' + (${articles.number} + 1)}">다음</a>
    </li>
    <!-- 마지막 페이지 링크 -->
    <li class="page-item" th:classappend="${articles.last} ? 'disabled' : ''">
      <a class="page-link"
         th:href="@{'/' + ${shopId} + '/community' + (${selectedBoard} != null ? '/' + ${selectedBoard.name} : '') + '?page=' + (${articles.totalPages} - 1)}">끝</a>
    </li>
  </ul>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>
</html>